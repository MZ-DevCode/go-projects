package main // package — объявление пакета. main — точка входа, чтобы программа могла запуститься.

import ( // import — ключевое слово для подключения библиотек (пакетов).
	"fmt"       // fmt — пакет для форматированного ввода/вывода (печать в консоль).
	"math/rand"  // math/rand — пакет для генерации случайных (рандомных) чисел.
	"time"      // time — пакет для работы со временем (паузы, длительность).
)

// func — объявление функции. racer — имя функции.
// name string — первый аргумент (строка).
// track chan string — второй аргумент (канал, передающий строки).
func racer(name string, track chan string) {
	
	// rand.Intn(2000) — генерирует случайное целое число от 0 до 1999.
	// time.Duration(...) — преобразует это число в тип "длительность".
	// * time.Millisecond — умножает число на 1 миллисекунду.
	// := — оператор краткого объявления и инициализации переменной delay.
	delay := time.Duration(rand.Intn(2000)) * time.Millisecond
	
	// time.Sleep — приостанавливает выполнение ТЕКУЩЕЙ горутины на время delay.
	time.Sleep(delay)
	
	// track <- name — оператор отправки. Мы "заталкиваем" значение name в канал track.
	// В этот момент горутина заблокируется, пока кто-то другой не заберет данные из канала.
	track <- name
}

// func main — главная функция, которая выполняется при старте программы.
func main() {
	
	// make — встроенная функция для создания (аллокации) сложных типов данных.
	// chan string — создаем канал, который может переносить только строки.
	// track := — создаем переменную track и записываем в неё этот канал.
	track := make(chan string)

	// go — МАГИЧЕСКОЕ слово. Запускает функцию racer в отдельном потоке (горутине).
	// Программа НЕ ждет выполнения racer и СРАЗУ переходит к следующей строке.
	go racer("Racer 1", track)
	
	// Запускаем второго гонщика параллельно первому.
	go racer("Racer 2", track)

	// <-track — оператор получения данных из канала.
	// ТУТ ВАЖНО: main ОСТАНАВЛИВАЕТСЯ на этой строке. Она ждет, пока кто-то положит данные в track.
	// Как только первый гонщик сделает track <- name, данные попадут в переменную winner.
	winner := <-track

	// fmt.Println — выводит текст и значение переменной winner в консоль.
	fmt.Println("Winner: ", winner)
	
} // После закрывающей скобки main программа завершается, убивая все запущенные горутины.
